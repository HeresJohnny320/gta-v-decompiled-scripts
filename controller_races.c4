// listener's C4 decompiler

void main() {
    l_2 = 1;
    l_3 = 134;
    l_4 = 134;
    l_5 = 1;
    l_6 = 1;
    l_7 = 1;
    l_8 = 134;
    l_9 = 1;
    l_A = 12;
    l_B = 12;
    l_E = 0.001;
    l_13 = "NULL";
    l_14 = 0.0;
    l_18 = -0.0375;
    l_19 = 0.17;
    if (PLAYER::_C968670BFACE42D9(82)) {
        sub_d4c();
    }
    if (SCRIPT::_GET_NUMBER_OF_INSTANCES_OF_STREAMED_SCRIPT(${controller_races}) > 1) {
        SCRIPT::TERMINATE_THIS_THREAD();
    }
    while (SCRIPT::_GET_NUMBER_OF_INSTANCES_OF_STREAMED_SCRIPT(${initial}) > 0) {
        SYSTEM::WAIT(0);
    }
    sub_cfe();
    while (1) {
        if (sub_aea(9) || g_154F7) {
            sub_d4c();
        }
        if (PLAYER::IS_PLAYER_PLAYING(PLAYER::PLAYER_ID())) {
            if (sub_a94()) {
                sub_9eb();
                sub_7cc();
                if (sub_635() == 1) {
                    switch (l_1B) {
                    case 1:
                        break;
                    case 2:
                        sub_e2();
                        break;
                    }
                }
            }
        }
        SYSTEM::WAIT(1000);
    }
}

void sub_e2() {
    if (sub_619(8)) {
        for (v_2 = 0; v_2 <= (5 - 1); v_2 += 1) {
            v_3 = sub_5c2(v_2);
            if (GAMEPLAY::IS_BIT_SET(g_17C4E._f6E10._f1, v_2)) {
                if (GAMEPLAY::IS_BIT_SET(g_17C4E._f6E10._f3, v_2)) {
                    v_4 = SYSTEM::VDIST2(sub_5af(PLAYER::PLAYER_ID()), sub_571(v_3, 0));
                    if (v_4 > 43681.0) {
                        if (!sub_535(v_3)) {
                            if (!g_17C34[v_2/*1*/]) {
                                sub_35f(v_3);
                                sub_256(v_3, 1, 1);
                                GAMEPLAY::CLEAR_BIT(&g_17C4E._f6E10._f3, v_2);
                            } else if ((GAMEPLAY::GET_GAME_TIMER() - g_17C3A[v_2/*1*/]) > 60000) {
                                g_17C34[v_2/*1*/] = 0;
                                g_17C3A[v_2/*1*/] = GAMEPLAY::GET_GAME_TIMER();
                                sub_35f(v_3);
                                sub_256(v_3, 1, 1);
                                GAMEPLAY::CLEAR_BIT(&g_17C4E._f6E10._f3, v_2);
                            }
                        } else { 
                            GAMEPLAY::CLEAR_BIT(&g_17C4E._f6E10._f3, v_2);
                        }
                    } else if (sub_535(v_3)) {
                        sub_256(v_3, 0, 1);
                    }
                } else if (!sub_535(v_3)) {
                    if (!g_17C34[v_2/*1*/]) {
                        sub_35f(v_3);
                        sub_256(v_3, 1, 1);
                    } else if ((GAMEPLAY::GET_GAME_TIMER() - g_17C3A[v_2/*1*/]) > 60000) {
                        g_17C34[v_2/*1*/] = 0;
                        g_17C3A[v_2/*1*/] = GAMEPLAY::GET_GAME_TIMER();
                        sub_35f(v_3);
                        sub_256(v_3, 1, 1);
                    }
                }
            }
        }
    }
}

void sub_256(auto a_0, auto a_1, auto a_2) {
    v_5 = a_0;
    if (((v_5 < 0) || (v_5 >= 262)) || (a_0 == 262)) {
        return ;
    }
    if (!a_2) {
        v_6 = GAMEPLAY::IS_BIT_SET(g_60AC[v_5/*23*/]._fB, 15);
        if (v_6 == a_1) {
            return ;
        }
    }
    if (a_1 != GAMEPLAY::IS_BIT_SET(g_60AC[v_5/*23*/]._fB, 0)) {
        GAMEPLAY::SET_BIT(&g_60AC[v_5/*23*/]._fB, 18);
        if (g_60A9 == 1) {
            g_60AA = 1;
        }
        g_60A9 = 1;
    }
    if (a_1) {
        GAMEPLAY::SET_BIT(&g_60AC[v_5/*23*/]._fB, 0);
        GAMEPLAY::SET_BIT(&g_60AC[v_5/*23*/]._fB, 15);
        GAMEPLAY::SET_BIT(&g_60AC[v_5/*23*/]._fB, 3);
    } else { 
        GAMEPLAY::CLEAR_BIT(&g_60AC[v_5/*23*/]._fB, 0);
        GAMEPLAY::CLEAR_BIT(&g_60AC[v_5/*23*/]._fB, 15);
    }
    if (!GAMEPLAY::IS_BIT_SET(g_60AC[v_5/*23*/]._fB, 0)) {
        if (UI::DOES_BLIP_EXIST(g_60AC[v_5/*23*/]._f13)) {
            GAMEPLAY::SET_THIS_SCRIPT_CAN_REMOVE_BLIPS_CREATED_BY_ANY_SCRIPT(1);
            UI::REMOVE_BLIP(&g_60AC[v_5/*23*/]._f13);
            GAMEPLAY::SET_THIS_SCRIPT_CAN_REMOVE_BLIPS_CREATED_BY_ANY_SCRIPT(0);
        }
    }
}

void sub_35f(auto a_0) {
    sub_489(a_0, 0, 0);
    sub_403(a_0, 1);
    sub_37d(a_0, 1);
}

void sub_37d(auto a_0, auto a_1) {
    v_4 = a_0;
    if (((v_4 < 0) || (v_4 >= 262)) || (a_0 == 262)) {
        return ;
    }
    if (a_1 == GAMEPLAY::IS_BIT_SET(g_60AC[v_4/*23*/]._fB, 4)) {
        return ;
    }
    if (a_1) {
        GAMEPLAY::SET_BIT(&g_60AC[v_4/*23*/]._fB, 4);
    } else { 
        GAMEPLAY::CLEAR_BIT(&g_60AC[v_4/*23*/]._fB, 4);
    }
    if (g_60A9 == 1) {
        g_60AA = 1;
    }
    g_60A9 = 1;
    GAMEPLAY::SET_BIT(&g_60AC[v_4/*23*/]._fB, 18);
}

void sub_403(auto a_0, auto a_1) {
    v_4 = a_0;
    if (((v_4 < 0) || (v_4 >= 262)) || (a_0 == 262)) {
        return ;
    }
    if (a_1 == GAMEPLAY::IS_BIT_SET(g_60AC[v_4/*23*/]._fB, 5)) {
        return ;
    }
    if (a_1) {
        GAMEPLAY::SET_BIT(&g_60AC[v_4/*23*/]._fB, 5);
    } else { 
        GAMEPLAY::CLEAR_BIT(&g_60AC[v_4/*23*/]._fB, 5);
    }
    if (g_60A9 == 1) {
        g_60AA = 1;
    }
    g_60A9 = 1;
    GAMEPLAY::SET_BIT(&g_60AC[v_4/*23*/]._fB, 18);
}

void sub_489(auto a_0, auto a_1, auto a_2) {
    v_5 = a_0;
    if (((v_5 < 0) || (v_5 >= 262)) || (a_0 == 262)) {
        return ;
    }
    if (a_1 == GAMEPLAY::IS_BIT_SET(g_60AC[v_5/*23*/]._fB, 6)) {
        return ;
    }
    if (a_1) {
        GAMEPLAY::SET_BIT(&g_60AC[v_5/*23*/]._fB, 6);
    } else { 
        GAMEPLAY::CLEAR_BIT(&g_60AC[v_5/*23*/]._fB, 6);
    }
    if (a_2) {
        GAMEPLAY::SET_BIT(&g_60AC[v_5/*23*/]._fB, 11);
    } else { 
        GAMEPLAY::CLEAR_BIT(&g_60AC[v_5/*23*/]._fB, 11);
    }
    if (g_60A9 == 1) {
        g_60AA = 1;
    }
    g_60A9 = 1;
    GAMEPLAY::SET_BIT(&g_60AC[v_5/*23*/]._fB, 18);
}

auto sub_535(auto a_0) {
    v_3 = a_0;
    if (((v_3 < 0) || (v_3 >= 262)) || (a_0 == 262)) {
        return 0;
    }
    return UI::DOES_BLIP_EXIST(g_60AC[v_3/*23*/]._f13);
}

auto<3> sub_571(auto a_0, auto a_1) {
    v_4 = a_0;
    if (((v_4 < 0) || (v_4 >= 262)) || (a_0 == 262)) {
        return {0.0, 0.0, 0.0 };
    }
    return g_60AC[v_4/*23*/][a_1/*3*/];
}

auto<3> sub_5af(auto a_0) {
    return ENTITY::GET_ENTITY_COORDS(PLAYER::GET_PLAYER_PED(a_0), 0);
}

auto sub_5c2(auto a_0) {
    switch (a_0) {
    case 0:
        return 85;
        break;
    case 1:
        return 86;
        break;
    case 2:
        return 87;
        break;
    case 3:
        return 88;
        break;
    case 4:
        return 89;
        break;
    }
    return 85;
}

auto sub_619(auto a_0) {
    return GAMEPLAY::IS_BIT_SET(g_17C4E._f1CAD._f63._fD9[0/*1*/], a_0);
}

auto sub_635() {
    sub_64e();
    return g_17C4E._f6C1._f21B._fC8D;
}

void sub_64e() {
    if (ENTITY::DOES_ENTITY_EXIST(PLAYER::PLAYER_PED_ID())) {
        if (sub_7a2(g_17C4E._f6C1._f21B._fC8D) != ENTITY::GET_ENTITY_MODEL(PLAYER::PLAYER_PED_ID())) {
            v_2 = sub_765(PLAYER::PLAYER_PED_ID());
            if (sub_759(v_2) && ((!sub_74b(14)) || g_17837)) {
                if ((g_17C4E._f6C1._f21B._fC8D != v_2) && sub_759(g_17C4E._f6C1._f21B._fC8D)) {
                    g_17C4E._f6C1._f21B._fC8E = g_17C4E._f6C1._f21B._fC8D;
                }
                g_17C4E._f6C1._f21B._fC8F = v_2;
                g_17C4E._f6C1._f21B._fC8D = v_2;
                return ;
            }
        } else { 
            if (g_17C4E._f6C1._f21B._fC8D != 145) {
                g_17C4E._f6C1._f21B._fC8F = g_17C4E._f6C1._f21B._fC8D;
            }
            return ;
        }
    }
    g_17C4E._f6C1._f21B._fC8D = 145;
}

auto sub_74b(auto a_0) {
    return g_8861 == a_0;
}

auto sub_759(auto a_0) {
    return a_0 < 3;
}

auto sub_765(auto a_0) {
    if (ENTITY::DOES_ENTITY_EXIST(a_0)) {
        v_4 = ENTITY::GET_ENTITY_MODEL(a_0);
        for (v_3 = 0; v_3 <= 2; v_3 += 1) {
            if (sub_7a2(v_3) == v_4) {
                return v_3;
            }
        }
    }
    return 145;
}

auto sub_7a2(auto a_0) {
    if (sub_759(a_0)) {
        return g_17C4E._f744E[a_0/*29*/];
    } else if (a_0 != 145) {}
    return 0;
}

void sub_7cc() {
    if (sub_619(7)) {
        for (v_2 = 0; v_2 <= (4 - 1); v_2 += 1) {
            v_3 = sub_9a2(v_2);
            if (GAMEPLAY::IS_BIT_SET(g_17C4E._f6E0D._f2, v_2)) {
                v_4 = SYSTEM::VDIST2(sub_5af(PLAYER::PLAYER_ID()), sub_571(v_3, 0));
                if (v_4 > 43681.0) {
                    if (!sub_535(v_3)) {
                        if (!g_17C2A[v_2/*1*/]) {
                            sub_35f(v_3);
                            sub_256(v_3, 1, 1);
                            GAMEPLAY::CLEAR_BIT(&g_17C4E._f6E0D._f2, v_2);
                        } else if ((GAMEPLAY::GET_GAME_TIMER() - g_17C2F[v_2/*1*/]) > 60000) {
                            g_17C2A[v_2/*1*/] = 0;
                            g_17C2F[v_2/*1*/] = GAMEPLAY::GET_GAME_TIMER();
                            sub_35f(v_3);
                            sub_256(v_3, 1, 1);
                            GAMEPLAY::CLEAR_BIT(&g_17C4E._f6E0D._f2, v_2);
                        }
                    }
                } else if (sub_535(v_3)) {
                    sub_256(v_3, 0, 1);
                }
            } else if (!sub_535(v_3)) {
                if (!g_17C2A[v_2/*1*/]) {
                    sub_35f(v_3);
                    sub_256(v_3, 1, 1);
                } else if ((GAMEPLAY::GET_GAME_TIMER() - g_17C2F[v_2/*1*/]) > 60000) {
                    g_17C2A[v_2/*1*/] = 0;
                    g_17C2F[v_2/*1*/] = GAMEPLAY::GET_GAME_TIMER();
                    sub_35f(v_3);
                    sub_256(v_3, 1, 1);
                }
            } else if (!g_17C4E._f6E0D) {
                if (v_3 == 81) {
                    sub_984(81);
                    sub_947(65, 1000);
                    g_17C4E._f6E0D = 1;
                }
            }
        }
    }
}

void sub_947(auto a_0, auto a_1) {
    if ((a_0 == 235) || (a_0 == 0)) {
        return ;
    }
    g_17C4E._f1AD5[a_0/*1*/] = 1;
    g_17C4E._f1AD5._fEC[a_0/*1*/] = GAMEPLAY::GET_GAME_TIMER() + a_1;
}

void sub_984(auto a_0) {
    sub_489(a_0, 1, 0);
    sub_403(a_0, 1);
    sub_37d(a_0, 1);
}

auto sub_9a2(auto a_0) {
    switch (a_0) {
    case 0:
        return 81;
        break;
    case 1:
        return 82;
        break;
    case 2:
        return 83;
        break;
    case 3:
        return 84;
        break;
    }
    return 81;
}

void sub_9eb() {
    switch (l_1B) {
    case 0:
        if ((TIME::GET_CLOCK_HOURS() < 20) && (TIME::GET_CLOCK_HOURS() >= 5)) {
            sub_a6c();
            l_1B = 1;
        } else { 
            l_1B = 2;
        }
        break;
    case 1:
        if ((TIME::GET_CLOCK_HOURS() >= 20) || (TIME::GET_CLOCK_HOURS() < 5)) {
            l_1B = 2;
        }
        break;
    case 2:
        if ((TIME::GET_CLOCK_HOURS() < 20) && (TIME::GET_CLOCK_HOURS() >= 5)) {
            sub_a6c();
            l_1B = 1;
        }
        break;
    }
}

void sub_a6c() {
    for (v_2 = 0; v_2 <= (5 - 1); v_2 += 1) {
        sub_256(sub_5c2(v_2), 0, 0);
    }
}

auto sub_a94() {
    if (sub_aea(9)) {
        return 0;
    }
    if (sub_ad0()) {
        return 0;
    }
    if (PLAYER::GET_PLAYER_WANTED_LEVEL(PLAYER::PLAYER_ID()) > 0) {
        return 0;
    }
    if (STREAMING::_D9D2CFFF49FAB35F()) {
        return 0;
    }
    return 1;
}

auto sub_ad0() {
    if (SCRIPT::_GET_NUMBER_OF_INSTANCES_OF_STREAMED_SCRIPT(${player_timetable_scene}) > 0) {
        return 1;
    }
    return 0;
}

auto sub_aea(auto a_0) {
    if (g_8861 == 15) {
        return 0;
    }
    if (sub_b0c(a_0)) {
        return 0;
    }
    return 1;
}

auto sub_b0c(auto a_0) {
    return sub_b1d(a_0, g_8861);
}

auto sub_b1d(auto a_0, auto a_1) {
    if (a_1 == 15) {
        return 1;
    }
    if (a_0 == 15) {
        return 0;
    }
    switch (a_0) {
    case 16:
        switch (a_1) {
        case 7:
        case 9:
        case 10:
        case 13:
        case 14:
            return 0;
            break;
        }
        return 1;
        break;
    case 0:
        switch (a_1) {
        case 5:
        case 17:
            return 1;
            break;
        }
        break;
    case 2:
    case 3:
        switch (a_1) {
        case 5:
        case 6:
        case 8:
        case 17:
            return 1;
            break;
        }
        break;
    case 4:
        if (a_1 == 17) {
            return 1;
        }
        break;
    case 5:
        break;
    case 6:
    case 8:
        if (a_1 == 5) {
            return 1;
        }
        break;
    case 7:
        if (a_1 == 6) {
            return 1;
        }
        break;
    case 9:
        if (a_1 == 5) {
            return 1;
        }
        break;
    case 10:
        switch (a_1) {
        case 5:
        case 6:
        case 17:
            return 1;
            break;
        }
        break;
    case 11:
        if (a_1 == 5) {
            return 1;
        }
        break;
    case 17:
        switch (a_1) {
        case 5:
        case 12:
        case 17:
            return 1;
            break;
        }
        break;
    case 12:
    case 18:
        switch (a_1) {
        case 5:
        case 6:
        case 8:
            return 1;
            break;
        }
        break;
    case 13:
        switch (a_1) {
        case 5:
            return 1;
            break;
        }
        break;
    case 14:
        switch (a_1) {
        case 5:
            return 1;
            break;
        }
        break;
    }
    return 0;
}

void sub_cfe() {
    for (v_2 = 0; v_2 <= (4 - 1); v_2 += 1) {
        g_17C2A[v_2/*1*/] = 0;
        g_17C2F[v_2/*1*/] = GAMEPLAY::GET_GAME_TIMER();
    }
    for (v_2 = 0; v_2 <= (5 - 1); v_2 += 1) {
        g_17C34[v_2/*1*/] = 0;
    }
}

void sub_d4c() {
    SCRIPT::TERMINATE_THIS_THREAD();
}